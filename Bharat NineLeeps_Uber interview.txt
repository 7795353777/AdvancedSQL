Question 1
    Table A
    1
    2
    3
    5
    null

    Table B
    1
    1
    4
    2
    1
    3
    null
    null

    Predict the output for below 3 case

    B left join A
    B innerjoin A
    B full outer join A

    Output Format:
    B.id, A.id

Answer 1
    B left join a 
    1   1
    1   1
    4   null
    2   2
    1   1
    3   3
    null null
    null    null


    b inner join A
    1    1
    1    1
    1    1
    2   2
    3   3

    b outer join a
    1   1
    1   1
    4   null
    2   2
    1   1
    3   3
    null    null
    null    null
    null    5
    null    null

Question 2
    products: product_id,product_name
    orders: order_id,product_id,order_date,quantity,amount

    Find the total sales of the product for last three months.
    If no sales happened the total sales value should be 0

    Output Format:
    product_name, total_sale_amount

Answer 2
    select p.product_name,coalese(c.TA,0)
    from 
    (
    select product_id,order_date ,Sum(amount) as TA
    from orders
    group by product_id,order_date
    having order_date > Dateadd(MONTH,-3,getdate()) as c
    right join products as p 
    on p.product_id=c.product_id

    select p.product_name,coalese(sum(o.amount),0) as total_sale_amount
    from product p 
    left join orders o
    on p.product_id=o.product_id
    and o.order_date> Dateadd(month,-3,getdate())
    group by p.product_id, p.product_name

Question 3
    Input list: [0,4,3,0,5,0,0,7,6,0]
    Output list: [4,3,5,7,6,0,0,0,0,0]

Answer 3
    result_output=[x for x in input_list if x !=0 ] +[0]*input_list.count(0)

    lenth=len(input_list)
    for i in range(lenth):
        if (input_list[i] ==0) and (i  <lenth):
            input_list[i],input_list[i+1]=input_list[i+1],input_list[i]
    print(input_list)

Question 4
    the pipeline runs independently every day. 
    If a job fails, a log entry is written to the failure table; 
    if it succeeds, the log entry is recorded in the success table.

    Identify continuous time intervals during which the pipeline remained in the same state 
    (either "success" or "failure").

    Input:

    Table: failure 
    Col: date

    Table: success 
    Col: date

    OUTPUT format:
    state, start_date, end_date

Answer 4 
    with un as(
    select date,'failure' as state union all
    select date ,'success' as state ),

    rn1 as (select *, row_number() over(order by date) as rnall,
                    row_number() over(partition by state order by date) as rnpart
                    from un),
    diff as (select *,rnall-rnpart as grps  from rn1)
    select state,min(date) as start_date, max(date) as end_date from diff group by state,grps


Question 5 : In hadoop block and split?
Question 6 : 1 big file 4gb 100 files total 4 gb in spark 2 cases what are the consequesnces while reading and writing?

